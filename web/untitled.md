---
description: jiketutu
---

# Go简单Web框架

### 这个框架是什么？

什么是框架？

web应用构建在web服务器上，功能总结为接收请求，返回响应。请求来源（URL）多种多样，类型（GET、PUT、POST）多种多样。还有中间件、模板等拓展功能。标准库提供的函数是很原子化的，不可能每次构建服务都使用最基本的原子化操作。于是框架应运而生，是构建web服务的脚手架，提供实现web应用的接口，增强web服务器功能。

框架实现了以下功能;

* 实现路由映射表，使用Trie实现动态路由解析，支持参数匹配和通配， 实现静态文件资源服务， 可供注册和查找快速构建响应体系，查找到相应的handle函数，可以支持发送本地静态文件
* 实现分组控制，支持中间件，针对不同路由前缀组增加不同的操作，丰富差异化功能
* 支持HTML Template渲染 ，根据模板库快速构建响应
* 实现错误处理机制，增强框架稳定性

### 前缀树路由

#### 参数匹配和通配是怎么实现的？

* **参数匹配`：`**。例如 `/p/:lang/doc`，可以匹配 `/p/c/doc` 和 `/p/go/doc`。
* **通配`*`**。例如 `/static/*filepath`，可以匹配`/static/fav.ico`，也可以匹配`/static/js/jQuery.js`，这种模式常用于静态服务器，能够递归地匹配子路径。

**通配的注册与匹配：**

通配路径路由注册时，在`*`段停止插入，该节点的pattern值为通配完整路径；在匹配路由时，匹配到`*`段时便可停止匹配，检查pattern不为空，即可完整匹配，之后尚未匹配的路径为静态文件查找时用到的路径，不影响匹配。

**解决方法：**

在`handler`函数中，调用`getRoute`函数，如果请求URL中有参数或通配，分析URL段时，如果前缀树当前节点含`*`或`:`，说明URL当前段为参数，便可在context的参数表中，添加当前参数所匹配的对象，供响应使用。  


